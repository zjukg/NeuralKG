<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GNNModel &mdash; NeuralKG-ind v1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Utils" href="neuralkg_ind.utils.html" />
    <link rel="prev" title="RuleModel" href="rulemodel.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> NeuralKG-ind
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Experiment Result</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="result.html">Results</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="neuralkg_ind.html">NeuralKG-ind</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="neuralkg_ind.data.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="neuralkg_ind.eval_task.html">Eval_Task</a></li>
<li class="toctree-l2"><a class="reference internal" href="neuralkg_ind.lit_model.html">Lit_Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="neuralkg_ind.loss.html">loss</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="neuralkg_ind.model.html">Model</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="kgemodel.html">KGEModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="rulemodel.html">RuleModel</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">GNNModel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.model">model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.layer">layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.RGCN">RGCN</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.CompGCN">CompGCN</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.SEGNN">SEGNN</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.XTransE">XTransE</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.KBAT">KBAT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.Grail">Grail</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.CoMPILE">CoMPILE</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.SNRI">SNRI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.RMPI">RMPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-neuralkg_ind.model.GNNModel.MorsE">MorsE</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="neuralkg_ind.utils.html">Utils</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NeuralKG-ind</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="neuralkg_ind.html">NeuralKG-ind</a> &raquo;</li>
          <li><a href="neuralkg_ind.model.html">Model</a> &raquo;</li>
      <li>GNNModel</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/zjukg/NeuralKG_ind/blob/main/docs/source/gnnmodel.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gnnmodel">
<h1>GNNModel<a class="headerlink" href="#gnnmodel" title="Permalink to this heading">¶</a></h1>
<section id="module-neuralkg_ind.model.GNNModel.model">
<span id="model"></span><h2>model<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.model" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.model.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.model.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/model.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.model.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.model.Model.init_emb">
<span class="sig-name descname"><span class="pre">init_emb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/model.html#Model.init_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.model.Model.init_emb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.model.Model.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/model.html#Model.build_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.model.Model.build_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.model.Model.build_hidden_layer">
<span class="sig-name descname"><span class="pre">build_hidden_layer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/model.html#Model.build_hidden_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.model.Model.build_hidden_layer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.model.Model.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/model.html#Model.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.model.Model.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.model.Model.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.model.Model.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-neuralkg_ind.model.GNNModel.layer">
<span id="layer"></span><h2>layer<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.layer" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.GNNLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.layer.</span></span><span class="sig-name descname"><span class="pre">GNNLayer</span></span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#GNNLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.GNNLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.GNNLayer.message">
<span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#GNNLayer.message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.GNNLayer.message" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.GNNLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#GNNLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.GNNLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.GNNLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.GNNLayer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.Aggregator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.layer.</span></span><span class="sig-name descname"><span class="pre">Aggregator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#Aggregator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.Aggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.Aggregator.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#Aggregator.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.Aggregator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.Aggregator.update_embedding">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nei_msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#Aggregator.update_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.Aggregator.update_embedding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.Aggregator.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.Aggregator.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.SUMAggregator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.layer.</span></span><span class="sig-name descname"><span class="pre">SUMAggregator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#SUMAggregator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.SUMAggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.layer.Aggregator" title="neuralkg_ind.model.GNNModel.layer.Aggregator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Aggregator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.SUMAggregator.update_embedding">
<span class="sig-name descname"><span class="pre">update_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nei_msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#SUMAggregator.update_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.SUMAggregator.update_embedding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.SUMAggregator.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.SUMAggregator.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.MLPAggregator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.layer.</span></span><span class="sig-name descname"><span class="pre">MLPAggregator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#MLPAggregator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.MLPAggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.layer.Aggregator" title="neuralkg_ind.model.GNNModel.layer.Aggregator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Aggregator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.MLPAggregator.update_embedding">
<span class="sig-name descname"><span class="pre">update_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nei_msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#MLPAggregator.update_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.MLPAggregator.update_embedding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.MLPAggregator.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.MLPAggregator.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.GRUAggregator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.layer.</span></span><span class="sig-name descname"><span class="pre">GRUAggregator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">emb_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#GRUAggregator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.GRUAggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.layer.Aggregator" title="neuralkg_ind.model.GNNModel.layer.Aggregator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Aggregator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.GRUAggregator.update_embedding">
<span class="sig-name descname"><span class="pre">update_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curr_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nei_msg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#GRUAggregator.update_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.GRUAggregator.update_embedding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.GRUAggregator.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.GRUAggregator.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.BatchGRU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.layer.</span></span><span class="sig-name descname"><span class="pre">BatchGRU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#BatchGRU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.BatchGRU" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.BatchGRU.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_scope</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/layer.html#BatchGRU.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.BatchGRU.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.layer.BatchGRU.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.layer.BatchGRU.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-neuralkg_ind.model.GNNModel.RGCN">
<span id="rgcn"></span><h2>RGCN<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.RGCN" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RGCN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.RGCN.</span></span><span class="sig-name descname"><span class="pre">RGCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RGCN.html#RGCN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RGCN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.model.Model" title="neuralkg_ind.model.GNNModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p><a class="reference external" href="https://arxiv.org/pdf/1703.06103.pdf">Modeling Relational Data with Graph Convolutional Networks</a> (RGCN), which use GCN framework to model relation data.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RGCN.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RGCN.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RGCN.init_emb">
<span class="sig-name descname"><span class="pre">init_emb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RGCN.html#RGCN.init_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RGCN.init_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the RGCN model and embeddings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ent_emb</strong> – Entity embedding, shape:[num_ent, emb_dim].</p></li>
<li><p><strong>rel_emb</strong> – Relation_embedding, shape:[num_rel, emb_dim].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RGCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RGCN.html#RGCN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RGCN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>The functions used in the training and testing phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – The knowledge graph recorded in dgl.graph()</p></li>
<li><p><strong>ent</strong> – The entitiy ids sampled in triples</p></li>
<li><p><strong>rel</strong> – The relation ids sampled in triples</p></li>
<li><p><strong>norm</strong> – The edge norm in graph</p></li>
<li><p><strong>triples</strong> – The triples ids, as (h, r, t), shape:[batch_size, 3].</p></li>
<li><p><strong>mode</strong> – Choose head-predict or tail-predict, Defaults to ‘single’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RGCN.get_score">
<span class="sig-name descname"><span class="pre">get_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RGCN.html#RGCN.get_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RGCN.get_score" title="Permalink to this definition">¶</a></dt>
<dd><p>The functions used in the testing phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – A batch of data.</p></li>
<li><p><strong>mode</strong> – Choose head-predict or tail-predict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RGCN.tri2emb">
<span class="sig-name descname"><span class="pre">tri2emb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RGCN.html#RGCN.tri2emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RGCN.tri2emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Get embedding of triples.</p>
<p>This function get the embeddings of head, relation, and tail
respectively. each embedding has three dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embedding</strong> (<em>tensor</em>) – This embedding save the entity embeddings.</p></li>
<li><p><strong>triples</strong> (<em>tensor</em>) – This tensor save triples id, which dimension is
[triples number, 3].</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><em>optional</em>) – This arg indicates that the negative entity
will replace the head or tail entity. when it is ‘single’, it
means that entity will not be replaced. Defaults to ‘single’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Head entity embedding.
rela_emb: Relation embedding.
tail_emb: Tail entity embedding.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>head_emb</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RGCN.build_hidden_layer">
<span class="sig-name descname"><span class="pre">build_hidden_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RGCN.html#RGCN.build_hidden_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RGCN.build_hidden_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>The functions used to initialize the RGCN model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> – it`s used to identify rgcn layers. The last rgcn layer should use</p></li>
<li><p><strong>function.</strong> (<em>relu as activation</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the relation graph convolution layer</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RGCN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RGCN.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RelGraphConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.RGCN.</span></span><span class="sig-name descname"><span class="pre">RelGraphConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_loop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RGCN.html#RelGraphConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RelGraphConv" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.layer.GNNLayer" title="neuralkg_ind.model.GNNModel.layer.GNNLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">GNNLayer</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RelGraphConv.message">
<span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RGCN.html#RelGraphConv.message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RelGraphConv.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Message function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RelGraphConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">presorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RGCN.html#RelGraphConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RelGraphConv.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RGCN.RelGraphConv.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RGCN.RelGraphConv.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-neuralkg_ind.model.GNNModel.CompGCN">
<span id="compgcn"></span><h2>CompGCN<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.CompGCN" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.CompGCN.</span></span><span class="sig-name descname"><span class="pre">CompGCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.model.Model" title="neuralkg_ind.model.GNNModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<dl class="simple">
<dt><a class="reference external" href="https://arxiv.org/pdf/1911.03082.pdf">Composition-based multi-relational graph convolutional networks</a> (CompGCN),</dt><dd><p>which jointly embeds both nodes and relations in a relational graph.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCN.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCN.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCN.init_emb">
<span class="sig-name descname"><span class="pre">init_emb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCN.init_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCN.init_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the CompGCN model and embeddings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ent_emb</strong> – Entity embedding, shape:[num_ent, emb_dim].</p></li>
<li><p><strong>rel_emb</strong> – Relation_embedding, shape:[num_rel, emb_dim].</p></li>
<li><p><strong>conv1</strong> – The convolution layer.</p></li>
<li><p><strong>fc</strong> – The full connection layer.</p></li>
<li><p><strong>bn0</strong> – The batch Normalization layer.</p></li>
<li><p><strong>bn1</strong> – The batch Normalization layer.</p></li>
<li><p><strong>bn2</strong> – The batch Normalization layer.</p></li>
<li><p><strong>inp_drop</strong> – The dropout layer.</p></li>
<li><p><strong>hid_drop</strong> – The dropout layer.</p></li>
<li><p><strong>feg_drop</strong> – The dropout layer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCN.build_hidden_layer">
<span class="sig-name descname"><span class="pre">build_hidden_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCN.build_hidden_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCN.build_hidden_layer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>The functions used in the training phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – The knowledge graph recorded in dgl.graph()</p></li>
<li><p><strong>relation</strong> – The relation id sampled in triples</p></li>
<li><p><strong>norm</strong> – The edge norm in graph</p></li>
<li><p><strong>triples</strong> – The triples ids, as (h, r, t), shape:[batch_size, 3].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCN.get_score">
<span class="sig-name descname"><span class="pre">get_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCN.get_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCN.get_score" title="Permalink to this definition">¶</a></dt>
<dd><p>The functions used in the testing phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – A batch of data.</p></li>
<li><p><strong>mode</strong> – Choose head-predict or tail-predict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCN.concat">
<span class="sig-name descname"><span class="pre">concat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ent_embed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_embed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCN.concat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCN.concat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCN.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.CompGCN.</span></span><span class="sig-name descname"><span class="pre">CompGCNCov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act=&lt;function</span> <span class="pre">CompGCNCov.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_rate=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opn='corr'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCNCov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.layer.GNNLayer" title="neuralkg_ind.model.GNNModel.layer.GNNLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">GNNLayer</span></code></a></p>
<p>The comp graph convolution layers, similar to <a class="reference external" href="https://github.com/malllabiisc/CompGCN">https://github.com/malllabiisc/CompGCN</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.get_param">
<span class="sig-name descname"><span class="pre">get_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCNCov.get_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.get_param" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.message">
<span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">EdgeBatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCNCov.message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.message" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.reduce_func">
<span class="sig-name descname"><span class="pre">reduce_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">NodeBatch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCNCov.reduce_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.reduce_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.comp">
<span class="sig-name descname"><span class="pre">comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCNCov.comp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.comp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_repr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_norm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CompGCN.html#CompGCNCov.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CompGCN.CompGCNCov.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-neuralkg_ind.model.GNNModel.SEGNN">
<span id="segnn"></span><h2>SEGNN<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.SEGNN" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.SEGNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.SEGNN.</span></span><span class="sig-name descname"><span class="pre">SEGNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SEGNN.html#SEGNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.SEGNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.SEGNN.concat">
<span class="sig-name descname"><span class="pre">concat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rela_emb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SEGNN.html#SEGNN.concat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.SEGNN.concat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.SEGNN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SEGNN.html#SEGNN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.SEGNN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>matching computation between query (h, r) and answer t.
:param h_id: head entity id, (bs, )
:param r_id: relation id, (bs, )
:param kg: aggregation graph
:return: matching score, (bs, n_ent)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.SEGNN.aggragate_emb">
<span class="sig-name descname"><span class="pre">aggragate_emb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SEGNN.html#SEGNN.aggragate_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.SEGNN.aggragate_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>aggregate embedding.
:param kg:
:return:</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.SEGNN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.SEGNN.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.CompLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.SEGNN.</span></span><span class="sig-name descname"><span class="pre">CompLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SEGNN.html#CompLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.CompLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.CompLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ent_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_emb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SEGNN.html#CompLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.CompLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.CompLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.CompLayer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.NodeLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.SEGNN.</span></span><span class="sig-name descname"><span class="pre">NodeLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SEGNN.html#NodeLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.NodeLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.NodeLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ent_emb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SEGNN.html#NodeLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.NodeLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.NodeLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.NodeLayer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.EdgeLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.SEGNN.</span></span><span class="sig-name descname"><span class="pre">EdgeLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SEGNN.html#EdgeLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.EdgeLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.EdgeLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.EdgeLayer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SEGNN.EdgeLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ent_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_emb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SEGNN.html#EdgeLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SEGNN.EdgeLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-neuralkg_ind.model.GNNModel.XTransE">
<span id="xtranse"></span><h2>XTransE<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.XTransE" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.XTransE.XTransE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.XTransE.</span></span><span class="sig-name descname"><span class="pre">XTransE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/XTransE.html#XTransE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.XTransE.XTransE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="kgemodel.html#neuralkg_ind.model.KGEModel.model.Model" title="neuralkg_ind.model.KGEModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p><a class="reference external" href="https://link.springer.com/content/pdf/10.1007%2F978-981-15-3412-6_8.pdf">Explainable Knowledge Graph Embedding for Link Prediction with Lifestyles in e-Commerce</a> (XTransE), which introduces the attention to aggregate the neighbor node representation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.XTransE.XTransE.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.XTransE.XTransE.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.XTransE.XTransE.init_emb">
<span class="sig-name descname"><span class="pre">init_emb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/XTransE.html#XTransE.init_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.XTransE.XTransE.init_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the entity and relation embeddings in the form of a uniform distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>margin</strong> – Caculate embedding_range and loss.</p></li>
<li><p><strong>embedding_range</strong> – Uniform distribution range.</p></li>
<li><p><strong>ent_emb</strong> – Entity embedding, shape:[num_ent, emb_dim].</p></li>
<li><p><strong>rel_emb</strong> – Relation_embedding, shape:[num_rel, emb_dim].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.XTransE.XTransE.score_func">
<span class="sig-name descname"><span class="pre">score_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">triples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/XTransE.html#XTransE.score_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.XTransE.XTransE.score_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculating the score of triples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>triples</strong> – The triples ids, as (h, r, t), shape:[batch_size, 3].</p></li>
<li><p><strong>neighbor</strong> – The neighbors of tail entities.</p></li>
<li><p><strong>mask</strong> – The mask of neighbor nodes</p></li>
<li><p><strong>negs</strong> – Negative samples, defaults to None.</p></li>
<li><p><strong>mode</strong> – Choose head-predict or tail-predict, Defaults to ‘single’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.XTransE.XTransE.transe_func">
<span class="sig-name descname"><span class="pre">transe_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rela_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_emb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/XTransE.html#XTransE.transe_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.XTransE.XTransE.transe_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculating the score of triples with TransE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head_emb</strong> – The head entity embedding.</p></li>
<li><p><strong>rela_emb</strong> – The relation embedding.</p></li>
<li><p><strong>tail_emb</strong> – The tail entity embedding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.XTransE.XTransE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">triples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/XTransE.html#XTransE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.XTransE.XTransE.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>The functions used in the training and testing phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>triples</strong> – The triples ids, as (h, r, t), shape:[batch_size, 3].</p></li>
<li><p><strong>neighbor</strong> – The neighbors of tail entities.</p></li>
<li><p><strong>mask</strong> – The mask of neighbor nodes</p></li>
<li><p><strong>negs</strong> – Negative samples, defaults to None.</p></li>
<li><p><strong>mode</strong> – Choose head-predict or tail-predict, Defaults to ‘single’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.XTransE.XTransE.get_score">
<span class="sig-name descname"><span class="pre">get_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/XTransE.html#XTransE.get_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.XTransE.XTransE.get_score" title="Permalink to this definition">¶</a></dt>
<dd><p>The functions used in the testing phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – A batch of data.</p></li>
<li><p><strong>mode</strong> – Choose head-predict or tail-predict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.XTransE.XTransE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.XTransE.XTransE.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-neuralkg_ind.model.GNNModel.KBAT">
<span id="kbat"></span><h2>KBAT<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.KBAT" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.KBAT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.KBAT.</span></span><span class="sig-name descname"><span class="pre">KBAT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#KBAT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.KBAT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt><a class="reference external" href="https://arxiv.org/pdf/1906.01195.pdf">Learning Attention-based Embeddings for Relation Prediction in Knowledge Graphs</a> (KBAT),</dt><dd><p>which introduces the attention to aggregate the neighbor node representation.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.KBAT.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.KBAT.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.KBAT.init_GAT_emb">
<span class="sig-name descname"><span class="pre">init_GAT_emb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#KBAT.init_GAT_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.KBAT.init_GAT_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the GAT model and embeddings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ent_emb_out</strong> – Entity embedding, shape:[num_ent, emb_dim].</p></li>
<li><p><strong>rel_emb_out</strong> – Relation_embedding, shape:[num_rel, emb_dim].</p></li>
<li><p><strong>entity_embeddings</strong> – The final embedding used in ConvKB.</p></li>
<li><p><strong>relation_embeddings</strong> – The final embedding used in ConvKB.</p></li>
<li><p><strong>attentions</strong> – The graph attention layers.</p></li>
<li><p><strong>out_att</strong> – The graph attention layers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.KBAT.init_ConvKB_emb">
<span class="sig-name descname"><span class="pre">init_ConvKB_emb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#KBAT.init_ConvKB_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.KBAT.init_ConvKB_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the ConvKB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conv_layer</strong> – The convolution layer.</p></li>
<li><p><strong>dropout</strong> – The dropout layer.</p></li>
<li><p><strong>ReLU</strong> – Relu activation function.</p></li>
<li><p><strong>fc_layer</strong> – The full connection layer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.KBAT.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">triples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#KBAT.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.KBAT.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>The functions used in the training and testing phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>triples</strong> – The triples ids, as (h, r, t), shape:[batch_size, 3].</p></li>
<li><p><strong>mode</strong> – The mode indicates that the model will be used, when it</p></li>
<li><p><strong>'GAT'</strong> (<em>is</em>) – </p></li>
<li><p><strong>model</strong> (<em>it means graph attetion</em>) – </p></li>
<li><p><strong>'ConvKB'</strong> (<em>when it is</em>) – </p></li>
</ul>
</dd>
</dl>
<p>:param :
:param it means ConvKB model.:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The score of triples.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.KBAT.get_score">
<span class="sig-name descname"><span class="pre">get_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#KBAT.get_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.KBAT.get_score" title="Permalink to this definition">¶</a></dt>
<dd><p>The functions used in the testing phase</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – A batch of data.</p></li>
<li><p><strong>mode</strong> – Choose head-predict or tail-predict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.KBAT.forward_Con">
<span class="sig-name descname"><span class="pre">forward_Con</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">triples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#KBAT.forward_Con"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.KBAT.forward_Con" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.KBAT.forward_GAT">
<span class="sig-name descname"><span class="pre">forward_GAT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">triples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adj_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hop</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#KBAT.forward_GAT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.KBAT.forward_GAT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.KBAT.cal_Con_score">
<span class="sig-name descname"><span class="pre">cal_Con_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rela_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_emb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#KBAT.cal_Con_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.KBAT.cal_Con_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculating the score of triples with ConvKB model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head_emb</strong> – The head entity embedding.</p></li>
<li><p><strong>rela_emb</strong> – The relation embedding.</p></li>
<li><p><strong>tail_emb</strong> – The tail entity embedding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.KBAT.cal_GAT_score">
<span class="sig-name descname"><span class="pre">cal_GAT_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_emb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#KBAT.cal_GAT_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.KBAT.cal_GAT_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculating the score of triples with TransE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head_emb</strong> – The head entity embedding.</p></li>
<li><p><strong>rela_emb</strong> – The relation embedding.</p></li>
<li><p><strong>tail_emb</strong> – The tail entity embedding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of triples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.KBAT.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.KBAT.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.KBAT.</span></span><span class="sig-name descname"><span class="pre">SpecialSpmmFunctionFinal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#SpecialSpmmFunctionFinal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
<p>Special function for only sparse region backpropataion layer, similar to <a class="reference external" href="https://arxiv.org/abs/1710.10903">https://arxiv.org/abs/1710.10903</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.forward">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#SpecialSpmmFunctionFinal.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the operation.</p>
<p>This function is to be overridden by all subclasses.</p>
<p>It must accept a context ctx as the first argument, followed by any
number of arguments (tensors or other types).</p>
<p>The context can be used to store arbitrary data that can be then
retrieved during the backward pass.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.backward">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#SpecialSpmmFunctionFinal.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.backward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a formula for differentiating the operation.</p>
<p>This function is to be overridden by all subclasses.</p>
<p>It must accept a context <code class="xref py py-attr docutils literal notranslate"><span class="pre">ctx</span></code> as the first argument, followed by
as many outputs as the <a class="reference internal" href="#neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.forward" title="neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.forward"><code class="xref py py-func docutils literal notranslate"><span class="pre">forward()</span></code></a> returned (None will be passed in
for non tensor outputs of the forward function),
and it should return as many tensors, as there were inputs to
<a class="reference internal" href="#neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.forward" title="neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.forward"><code class="xref py py-func docutils literal notranslate"><span class="pre">forward()</span></code></a>. Each argument is the gradient w.r.t the given output,
and each returned value should be the gradient w.r.t. the
corresponding input. If an input is not a Tensor or is a Tensor not
requiring grads, you can just pass None as a gradient for that input.</p>
<p>The context can be used to retrieve tensors saved during the forward
pass. It also has an attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">ctx.needs_input_grad</span></code> as a tuple
of booleans representing whether each input needs gradient. E.g.,
<a class="reference internal" href="#neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.backward" title="neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.backward"><code class="xref py py-func docutils literal notranslate"><span class="pre">backward()</span></code></a> will have <code class="docutils literal notranslate"><span class="pre">ctx.needs_input_grad[0]</span> <span class="pre">=</span> <span class="pre">True</span></code> if the
first input to <a class="reference internal" href="#neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.forward" title="neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFunctionFinal.forward"><code class="xref py py-func docutils literal notranslate"><span class="pre">forward()</span></code></a> needs gradient computated w.r.t. the
output.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFinal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.KBAT.</span></span><span class="sig-name descname"><span class="pre">SpecialSpmmFinal</span></span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#SpecialSpmmFinal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFinal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Special spmm final layer, similar to <a class="reference external" href="https://arxiv.org/abs/1710.10903">https://arxiv.org/abs/1710.10903</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFinal.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#SpecialSpmmFinal.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFinal.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFinal.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.SpecialSpmmFinal.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.GraphAttentionLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.KBAT.</span></span><span class="sig-name descname"><span class="pre">GraphAttentionLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrela_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#GraphAttentionLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.GraphAttentionLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Sparse version GAT layer, similar to <a class="reference external" href="https://arxiv.org/abs/1710.10903">https://arxiv.org/abs/1710.10903</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.GraphAttentionLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_embed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_list_nhop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_embed_nhop</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/KBAT.html#GraphAttentionLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.GraphAttentionLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.KBAT.GraphAttentionLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.KBAT.GraphAttentionLayer.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-neuralkg_ind.model.GNNModel.Grail">
<span id="grail"></span><h2>Grail<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.Grail" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.Grail">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.Grail.</span></span><span class="sig-name descname"><span class="pre">Grail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/Grail.html#Grail"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.Grail" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p><a class="reference external" href="https://arxiv.org/abs/1911.06962">Inductive Relation Prediction by Subgraph Reasoning</a> (Grail), which reasons over local subgraph structures.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.Grail.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.Grail.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.Grail.rel_emb">
<span class="sig-name descname"><span class="pre">rel_emb</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.Grail.rel_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Entity embedding, shape: [num_rel, rel_emb_dim].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.Grail.gnn">
<span class="sig-name descname"><span class="pre">gnn</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.Grail.gnn" title="Permalink to this definition">¶</a></dt>
<dd><p>RGCN model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.Grail.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/Grail.html#Grail.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.Grail.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>calculating subgraphs score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Tuple of subgraphs and relation labels.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of subgraphs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.Grail.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.Grail.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.Grail.</span></span><span class="sig-name descname"><span class="pre">RGCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basiclayer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/Grail.html#RGCN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.model.Model" title="neuralkg_ind.model.GNNModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p>RGCN model</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN.basiclayer">
<span class="sig-name descname"><span class="pre">basiclayer</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN.basiclayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Layer of RGCN model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN.inp_dim">
<span class="sig-name descname"><span class="pre">inp_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN.inp_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of input.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN.emb_dim">
<span class="sig-name descname"><span class="pre">emb_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN.emb_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of embedding.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN.has_attn">
<span class="sig-name descname"><span class="pre">has_attn</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN.has_attn" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether there is attention mechanism.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN.attn_rel_emb">
<span class="sig-name descname"><span class="pre">attn_rel_emb</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN.attn_rel_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Embedding of relation attention.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN.attn_rel_emb_dim">
<span class="sig-name descname"><span class="pre">attn_rel_emb_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN.attn_rel_emb_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of relation attention Embedding.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN.init_emb">
<span class="sig-name descname"><span class="pre">init_emb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/Grail.html#RGCN.init_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN.init_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the relation attention embedding, aggregator and features.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN.build_hidden_layer">
<span class="sig-name descname"><span class="pre">build_hidden_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/Grail.html#RGCN.build_hidden_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN.build_hidden_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>build hidden layer of RGCN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> – The idx of layer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Build a basic layer according to whether it is the first layer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rela</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/Grail.html#RGCN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Getting node and relation embedding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – Subgraph of corresponding triple.</p></li>
<li><p><strong>rela</strong> – Embedding of relation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Node embedding.
rela: Relation embedding.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>graph.ndata.pop(‘h’)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RGCN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RGCN.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.Grail.</span></span><span class="sig-name descname"><span class="pre">RelAttGraphConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inp_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_rel_emb_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_input_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/Grail.html#RelAttGraphConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.RGCN.RelGraphConv" title="neuralkg_ind.model.GNNModel.RGCN.RelGraphConv"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelGraphConv</span></code></a></p>
<p>Basic layer of RGCN.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.bias">
<span class="sig-name descname"><span class="pre">bias</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight bias.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.inp_dim">
<span class="sig-name descname"><span class="pre">inp_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.inp_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of input.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.out_dim">
<span class="sig-name descname"><span class="pre">out_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.out_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of output.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.num_rels">
<span class="sig-name descname"><span class="pre">num_rels</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.num_rels" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of relations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.num_bases">
<span class="sig-name descname"><span class="pre">num_bases</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.num_bases" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of bases.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.has_attn">
<span class="sig-name descname"><span class="pre">has_attn</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.has_attn" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether there is attention mechanism.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.is_input_layer">
<span class="sig-name descname"><span class="pre">is_input_layer</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.is_input_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether it is input layer.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.aggregator">
<span class="sig-name descname"><span class="pre">aggregator</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.aggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of aggregator.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.weight">
<span class="sig-name descname"><span class="pre">weight</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.w_comp">
<span class="sig-name descname"><span class="pre">w_comp</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.w_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.self_loop_weight">
<span class="sig-name descname"><span class="pre">self_loop_weight</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.self_loop_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Self-loop weight.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.edge_dropout">
<span class="sig-name descname"><span class="pre">edge_dropout</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.edge_dropout" title="Permalink to this definition">¶</a></dt>
<dd><p>Dropout of edge.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.propagate">
<span class="sig-name descname"><span class="pre">propagate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_rel_emb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/Grail.html#RelAttGraphConv.propagate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Message propagate function.</p>
<p>Propagate messages and perform calculations according to the graph traversal order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – Subgraph of triple.</p></li>
<li><p><strong>attn_rel_emb</strong> – Relation attention embedding.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_emb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_rel_emb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/Grail.html#RelAttGraphConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.Grail.RelAttGraphConv.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Update node representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – Subgraph of corresponding triple.</p></li>
<li><p><strong>rel_emb</strong> – Embedding of relation.</p></li>
<li><p><strong>attn_rel_emb</strong> – Embedding of relation attention.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Embedding of relation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rel_emb</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-neuralkg_ind.model.GNNModel.CoMPILE">
<span id="compile"></span><h2>CoMPILE<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.CoMPILE" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.CoMPILE.</span></span><span class="sig-name descname"><span class="pre">CoMPILE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CoMPILE.html#CoMPILE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt><a class="reference external" href="https://arxiv.org/pdf/2012.08911">Communicative Message Passing for Inductive Relation Reasoning</a> (CoMPILE), which reasons over</dt><dd><p>local directed subgraph structures and strengthens the message interactions between edges and
entitles through a communicative kernel.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.latent_dim">
<span class="sig-name descname"><span class="pre">latent_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.latent_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Latent dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.output_dim">
<span class="sig-name descname"><span class="pre">output_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.output_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Output dimension.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.node_emb">
<span class="sig-name descname"><span class="pre">node_emb</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.node_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of node embedding.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.relation_emb">
<span class="sig-name descname"><span class="pre">relation_emb</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.relation_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of relation embedding.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.hidden_size">
<span class="sig-name descname"><span class="pre">hidden_size</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.hidden_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of hidden layer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subgraph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CoMPILE.html#CoMPILE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>calculating subgraphs score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>subgraph</strong> – Subgraph of triple.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The output of convolution layer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>out_conv</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.batch_subgraph">
<span class="sig-name descname"><span class="pre">batch_subgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subgraph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CoMPILE.html#CoMPILE.batch_subgraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.batch_subgraph" title="Permalink to this definition">¶</a></dt>
<dd><p>calculating subgraphs score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>subgraph</strong> – Subgraph of triple.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Embedding of subgraph.
source_embed: Embedding of source entities.
target_embed: Embedding of target entities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>graph_embed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.CoMPILEConv">
<span class="sig-name descname"><span class="pre">CoMPILEConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2n_sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2n_sp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_sizes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_degs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CoMPILE.html#CoMPILE.CoMPILEConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.CoMPILEConv" title="Permalink to this definition">¶</a></dt>
<dd><p>calculating graph embedding, source embedding and target embedding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_feat</strong> – Feature of nodes.</p></li>
<li><p><strong>edge_feat</strong> – Feature of edges.</p></li>
<li><p><strong>e2n_sp</strong> – Sparse matrix of edges to source nodes.</p></li>
<li><p><strong>e2n_sp2</strong> – Sparse matrix of edges to target nodes.</p></li>
<li><p><strong>graph_sizes</strong> – The number of each graph nodes.</p></li>
<li><p><strong>target_relation</strong> – Target relation label.</p></li>
<li><p><strong>total_source</strong> – Total source nodes.</p></li>
<li><p><strong>total_target</strong> – Total target nodes.</p></li>
<li><p><strong>source_node</strong> – Source node of triple.</p></li>
<li><p><strong>target_node</strong> – Target node of triple.</p></li>
<li><p><strong>edge_sizes</strong> – The sizes of edges.</p></li>
<li><p><strong>node_degs</strong> – The degrees of nodes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Graph embedding.
source_embed: source node embedding.
target_embed: target node embedding.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>gmol_vecs</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.CoMPILE.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.MySpMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.CoMPILE.</span></span><span class="sig-name descname"><span class="pre">MySpMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CoMPILE.html#MySpMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.MySpMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.forward">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sp_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CoMPILE.html#MySpMM.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the operation.</p>
<p>This function is to be overridden by all subclasses.</p>
<p>It must accept a context ctx as the first argument, followed by any
number of arguments (tensors or other types).</p>
<p>The context can be used to store arbitrary data that can be then
retrieved during the backward pass.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.backward">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CoMPILE.html#MySpMM.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.backward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a formula for differentiating the operation.</p>
<p>This function is to be overridden by all subclasses.</p>
<p>It must accept a context <code class="xref py py-attr docutils literal notranslate"><span class="pre">ctx</span></code> as the first argument, followed by
as many outputs as the <a class="reference internal" href="#neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.forward" title="neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.forward"><code class="xref py py-func docutils literal notranslate"><span class="pre">forward()</span></code></a> returned (None will be passed in
for non tensor outputs of the forward function),
and it should return as many tensors, as there were inputs to
<a class="reference internal" href="#neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.forward" title="neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.forward"><code class="xref py py-func docutils literal notranslate"><span class="pre">forward()</span></code></a>. Each argument is the gradient w.r.t the given output,
and each returned value should be the gradient w.r.t. the
corresponding input. If an input is not a Tensor or is a Tensor not
requiring grads, you can just pass None as a gradient for that input.</p>
<p>The context can be used to retrieve tensors saved during the forward
pass. It also has an attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">ctx.needs_input_grad</span></code> as a tuple
of booleans representing whether each input needs gradient. E.g.,
<a class="reference internal" href="#neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.backward" title="neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.backward"><code class="xref py py-func docutils literal notranslate"><span class="pre">backward()</span></code></a> will have <code class="docutils literal notranslate"><span class="pre">ctx.needs_input_grad[0]</span> <span class="pre">=</span> <span class="pre">True</span></code> if the
first input to <a class="reference internal" href="#neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.forward" title="neuralkg_ind.model.GNNModel.CoMPILE.MySpMM.forward"><code class="xref py py-func docutils literal notranslate"><span class="pre">forward()</span></code></a> needs gradient computated w.r.t. the
output.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.CoMPILE.gnn_spmm">
<span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.CoMPILE.</span></span><span class="sig-name descname"><span class="pre">gnn_spmm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/CoMPILE.html#gnn_spmm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.CoMPILE.gnn_spmm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-neuralkg_ind.model.GNNModel.SNRI">
<span id="snri"></span><h2>SNRI<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.SNRI" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.SNRI.</span></span><span class="sig-name descname"><span class="pre">SNRI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#SNRI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt><a class="reference external" href="https://arxiv.org/abs/2208.00850">Subgraph Neighboring Relations Infomax for Inductive Link Prediction on Knowledge Graphs</a> (SNRI), which sufficiently</dt><dd><p>exploits complete neighboring relationsfrom two aspects and apply mutual information (MI) maximization for knowledge graph.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.gnn">
<span class="sig-name descname"><span class="pre">gnn</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.gnn" title="Permalink to this definition">¶</a></dt>
<dd><p>RGCN model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.rel_emb">
<span class="sig-name descname"><span class="pre">rel_emb</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.rel_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Relation embedding, shape: [num_rel + 1, inp_dim].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.ent_padding">
<span class="sig-name descname"><span class="pre">ent_padding</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.ent_padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Entity padding, shape: [1, sem_dim].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.w_rel2ent">
<span class="sig-name descname"><span class="pre">w_rel2ent</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.w_rel2ent" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight matrix of relation to entity.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.init_ent_emb_matrix">
<span class="sig-name descname"><span class="pre">init_ent_emb_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#SNRI.init_ent_emb_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.init_ent_emb_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize feature of entities by matrix form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>g</strong> – The dgl graph of meta task.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.comp_ht_emb">
<span class="sig-name descname"><span class="pre">comp_ht_emb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_embs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_embs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#SNRI.comp_ht_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.comp_ht_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>combining embedding of head and tail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head_embs</strong> – Embedding of heads.</p></li>
<li><p><strong>tail_embs</strong> – Embedding of tails.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Embedding of head and tail.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ht_embs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.comp_hrt_emb">
<span class="sig-name descname"><span class="pre">comp_hrt_emb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_emb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#SNRI.comp_hrt_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.comp_hrt_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>combining embedding of head, relation and tail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head_emb</strong> – Embedding of head.</p></li>
<li><p><strong>relation_emb</strong> – Embedding of relation.</p></li>
<li><p><strong>tail_emb</strong> – Embedding of tail.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Embedding of head, relation and tail.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>hrt_embs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.nei_rel_path">
<span class="sig-name descname"><span class="pre">nei_rel_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_emb_out</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#SNRI.nei_rel_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.nei_rel_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Neighboring relational path module.</p>
<p>Only consider in-degree relations first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – Subgraph of corresponding triple.</p></li>
<li><p><strong>rel_labels</strong> – Labels of relation.</p></li>
<li><p><strong>r_emb_out</strong> – Embedding of relation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregate paths.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.get_logits">
<span class="sig-name descname"><span class="pre">get_logits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_g_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_g_cor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#SNRI.get_logits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.get_logits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_return_emb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cor_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#SNRI.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Getting the subgraph-level embedding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Subgraphs and relation labels.</p></li>
<li><p><strong>is_return_emb</strong> – Whether return embedding.</p></li>
<li><p><strong>cor_graph</strong> – Whether corrupt the node feature.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Representaion of subgraph.
s_G: Global Subgraph embeddings.
s_g: Local Subgraph embeddings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.SNRI.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.SNRI.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.SNRI.</span></span><span class="sig-name descname"><span class="pre">RelCompGraphConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inp_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_rel_emb_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_input_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#RelCompGraphConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.RGCN.RelGraphConv" title="neuralkg_ind.model.GNNModel.RGCN.RelGraphConv"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelGraphConv</span></code></a></p>
<p>Basic layer of RGCN for SNRI.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.bias">
<span class="sig-name descname"><span class="pre">bias</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight bias.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.inp_dim">
<span class="sig-name descname"><span class="pre">inp_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.inp_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of input.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.out_dim">
<span class="sig-name descname"><span class="pre">out_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.out_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of output.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.num_rels">
<span class="sig-name descname"><span class="pre">num_rels</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.num_rels" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of relations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.num_bases">
<span class="sig-name descname"><span class="pre">num_bases</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.num_bases" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of bases.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.has_attn">
<span class="sig-name descname"><span class="pre">has_attn</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.has_attn" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether there is attention mechanism.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.is_input_layer">
<span class="sig-name descname"><span class="pre">is_input_layer</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.is_input_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether it is input layer.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.aggregator">
<span class="sig-name descname"><span class="pre">aggregator</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.aggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of aggregator.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.weight">
<span class="sig-name descname"><span class="pre">weight</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.w_comp">
<span class="sig-name descname"><span class="pre">w_comp</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.w_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.self_loop_weight">
<span class="sig-name descname"><span class="pre">self_loop_weight</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.self_loop_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Self-loop weight.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.edge_dropout">
<span class="sig-name descname"><span class="pre">edge_dropout</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.edge_dropout" title="Permalink to this definition">¶</a></dt>
<dd><p>Dropout of edge.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.propagate">
<span class="sig-name descname"><span class="pre">propagate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_rel_emb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#RelCompGraphConv.propagate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Message propagate function.</p>
<p>Propagate messages and perform calculations according to the graph traversal order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – Subgraph of triple.</p></li>
<li><p><strong>attn_rel_emb</strong> – Relation attention embedding.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_rel_emb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#RelCompGraphConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.RelCompGraphConv.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Update node representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – Subgraph of corresponding triple.</p></li>
<li><p><strong>rel_emb</strong> – Embedding of relation.</p></li>
<li><p><strong>attn_rel_emb</strong> – Embedding of relation attention.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Embedding of relation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rel_emb_out</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.Discriminator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.SNRI.</span></span><span class="sig-name descname"><span class="pre">Discriminator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#Discriminator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.Discriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Discriminator module for calculating MI.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.Discriminator.n_e">
<span class="sig-name descname"><span class="pre">n_e</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.Discriminator.n_e" title="Permalink to this definition">¶</a></dt>
<dd><p>dimension of edge embedding.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.Discriminator.n_g">
<span class="sig-name descname"><span class="pre">n_g</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.Discriminator.n_g" title="Permalink to this definition">¶</a></dt>
<dd><p>dimension of graph embedding.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.Discriminator.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.Discriminator.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.Discriminator.weights_init">
<span class="sig-name descname"><span class="pre">weights_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#Discriminator.weights_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.Discriminator.weights_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Init weights of layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m</strong> – Model layer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.Discriminator.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_pl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_mi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_bias1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_bias2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/SNRI.html#Discriminator.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.Discriminator.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>For calculating MI loss.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.Discriminator.c">
<span class="sig-name descname"><span class="pre">c</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.Discriminator.c" title="Permalink to this definition">¶</a></dt>
<dd><p>Global Subgraph embeddings.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.Discriminator.h_pl">
<span class="sig-name descname"><span class="pre">h_pl</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.Discriminator.h_pl" title="Permalink to this definition">¶</a></dt>
<dd><p>Positive local Subgraph embeddings.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.Discriminator.h_mi">
<span class="sig-name descname"><span class="pre">h_mi</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.Discriminator.h_mi" title="Permalink to this definition">¶</a></dt>
<dd><p>Negative local Subgraph embeddings.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.Discriminator.s_bias1">
<span class="sig-name descname"><span class="pre">s_bias1</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.Discriminator.s_bias1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bias of sc_1.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.SNRI.Discriminator.s_bias2">
<span class="sig-name descname"><span class="pre">s_bias2</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.SNRI.Discriminator.s_bias2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bias of sc_2.</p>
</dd></dl>

</dd></dl>

</dd></dl>

</section>
<section id="module-neuralkg_ind.model.GNNModel.RMPI">
<span id="rmpi"></span><h2>RMPI<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.RMPI" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RMPI.RMPI">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.RMPI.</span></span><span class="sig-name descname"><span class="pre">RMPI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RMPI.html#RMPI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RMPI.RMPI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt><a class="reference external" href="https://arxiv.org/abs/2210.03994">Relational Message Passing for Fully Inductive Knowledge Graph Completion</a> (RMPI), which passes messages directly</dt><dd><p>between relations to make full use of the relation patterns for subgraph reasoning with new techniques on graph
transformation, graph pruning, relationaware neighborhood attention, addressing empty subgraphs, etc.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RMPI.RMPI.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RMPI.RMPI.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RMPI.RMPI.rel_emb">
<span class="sig-name descname"><span class="pre">rel_emb</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RMPI.RMPI.rel_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Relation embedding, shape: [num_rel, rel_emb_dim].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RMPI.RMPI.conc">
<span class="sig-name descname"><span class="pre">conc</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RMPI.RMPI.conc" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether apply target-aware attention for 2-hop neighbors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RMPI.RMPI.AggregateConv">
<span class="sig-name descname"><span class="pre">AggregateConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggr_flag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_drop</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RMPI.html#RMPI.AggregateConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RMPI.RMPI.AggregateConv" title="Permalink to this definition">¶</a></dt>
<dd><p>Function of aggregating relation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> – Subgraph to corresponding triple.</p></li>
<li><p><strong>u_node</strong> – Node of head entities.</p></li>
<li><p><strong>v_node</strong> – Node of tail entities.</p></li>
<li><p><strong>num_nodes</strong> – The number of nodes.</p></li>
<li><p><strong>num_edges</strong> – The number of edges.</p></li>
<li><p><strong>agg_flag</strong> – 2: 2-hop neighbors
1: 1-hop directed neighbors
0: 1-hop disclosing directed neighbors</p></li>
<li><p><strong>drop</strong> – Whether mask edges.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>embedding of relation neighbors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rel_neighbor_embd</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RMPI.RMPI.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RMPI.html#RMPI.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RMPI.RMPI.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>calculating subgraphs score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – Enclosing/disclosing subgraphs and relation labels.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>socore of subgraphs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RMPI.RMPI.sparse_dense_mul">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sparse_dense_mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RMPI.html#RMPI.sparse_dense_mul"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RMPI.RMPI.sparse_dense_mul" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RMPI.RMPI.sparse_index_select">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sparse_index_select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/RMPI.html#RMPI.sparse_index_select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RMPI.RMPI.sparse_index_select" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.RMPI.RMPI.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.RMPI.RMPI.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-neuralkg_ind.model.GNNModel.MorsE">
<span id="morse"></span><h2>MorsE<a class="headerlink" href="#module-neuralkg_ind.model.GNNModel.MorsE" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.MorsE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.MorsE.</span></span><span class="sig-name descname"><span class="pre">MorsE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#MorsE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.MorsE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="simple">
<dt><a class="reference external" href="https://arxiv.org/abs/2110.14170">Meta-Knowledge Transfer for Inductive Knowledge Graph Embedding</a> (MorsE), which learns transferable meta-knowledge that</dt><dd><p>can be used to produce entity embeddings.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.MorsE.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.MorsE.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.MorsE.ent_init">
<span class="sig-name descname"><span class="pre">ent_init</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.MorsE.ent_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Relation embedding init class.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.MorsE.rgcn">
<span class="sig-name descname"><span class="pre">rgcn</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.MorsE.rgcn" title="Permalink to this definition">¶</a></dt>
<dd><p>RGCN model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.MorsE.KGEModel">
<span class="sig-name descname"><span class="pre">KGEModel</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.MorsE.KGEModel" title="Permalink to this definition">¶</a></dt>
<dd><p>KGE model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.MorsE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ent_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#MorsE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.MorsE.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculating triple score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> – Sampled triplets.</p></li>
<li><p><strong>ent_emb</strong> – Embedding of entities.</p></li>
<li><p><strong>mode</strong> – This arg indicates that negative entity will replace the head or tail entity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Score of triple.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.MorsE.get_intest_train_g">
<span class="sig-name descname"><span class="pre">get_intest_train_g</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#MorsE.get_intest_train_g"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.MorsE.get_intest_train_g" title="Permalink to this definition">¶</a></dt>
<dd><p>Getting inductive test-train graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>test-train graph.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>indtest_train_g</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.MorsE.get_ent_emb">
<span class="sig-name descname"><span class="pre">get_ent_emb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sup_g_bidir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#MorsE.get_ent_emb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.MorsE.get_ent_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Getting entities embedding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sup_g_bidir</strong> – Undirected supporting graph.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Embedding of entities.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ent_emb</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.MorsE.get_score">
<span class="sig-name descname"><span class="pre">get_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#MorsE.get_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.MorsE.get_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Getting score of triplets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> – Including positive sample, entities embedding, etc.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Score of positive or negative sample.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.MorsE.get_num_rel">
<span class="sig-name descname"><span class="pre">get_num_rel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#MorsE.get_num_rel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.MorsE.get_num_rel" title="Permalink to this definition">¶</a></dt>
<dd><p>Getting number of relation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – Model configuration parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of relation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>num_rel</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.MorsE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.MorsE.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.EntInit">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.MorsE.</span></span><span class="sig-name descname"><span class="pre">EntInit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#EntInit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.EntInit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Class of initializing entities.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.EntInit.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.EntInit.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.EntInit.rel_head_emb">
<span class="sig-name descname"><span class="pre">rel_head_emb</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.EntInit.rel_head_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Embedding of relation to head.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.EntInit.rel_tail_emb">
<span class="sig-name descname"><span class="pre">rel_tail_emb</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.EntInit.rel_tail_emb" title="Permalink to this definition">¶</a></dt>
<dd><p>Embedding of relation to tail.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.EntInit.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_bidir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#EntInit.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.EntInit.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize entities in graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>g_bidir</strong> – Undirected graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.EntInit.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.EntInit.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.MorsE.</span></span><span class="sig-name descname"><span class="pre">RelMorsGraphConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inp_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_input_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_attn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#RelMorsGraphConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.RGCN.RelGraphConv" title="neuralkg_ind.model.GNNModel.RGCN.RelGraphConv"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelGraphConv</span></code></a></p>
<p>Basic layer of RGCN.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.bias">
<span class="sig-name descname"><span class="pre">bias</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.bias" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight bias.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.inp_dim">
<span class="sig-name descname"><span class="pre">inp_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.inp_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of input.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.out_dim">
<span class="sig-name descname"><span class="pre">out_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.out_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of output.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.num_rels">
<span class="sig-name descname"><span class="pre">num_rels</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.num_rels" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of relations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.num_bases">
<span class="sig-name descname"><span class="pre">num_bases</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.num_bases" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of bases.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.has_attn">
<span class="sig-name descname"><span class="pre">has_attn</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.has_attn" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether there is attention mechanism.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.is_input_layer">
<span class="sig-name descname"><span class="pre">is_input_layer</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.is_input_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether it is input layer.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.aggregator">
<span class="sig-name descname"><span class="pre">aggregator</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.aggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of aggregator.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.weight">
<span class="sig-name descname"><span class="pre">weight</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.w_comp">
<span class="sig-name descname"><span class="pre">w_comp</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.w_comp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.self_loop_weight">
<span class="sig-name descname"><span class="pre">self_loop_weight</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.self_loop_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Self-loop weight.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.edge_dropout">
<span class="sig-name descname"><span class="pre">edge_dropout</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.edge_dropout" title="Permalink to this definition">¶</a></dt>
<dd><p>Dropout of edge.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.message">
<span class="sig-name descname"><span class="pre">message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#RelMorsGraphConv.message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Message function for propagating.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>edges</strong> – Edges in graph.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Embedding of current layer.
msg: Message for propagating.
a: Coefficient.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>curr_emb</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.apply_node_func">
<span class="sig-name descname"><span class="pre">apply_node_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#RelMorsGraphConv.apply_node_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.apply_node_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Function used for nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nodes</strong> – nodes in graph.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Representation of nodes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>node_repr</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#RelMorsGraphConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Update node representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>g</strong> – Subgraph of corresponding triple.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RelMorsGraphConv.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RGCN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.MorsE.</span></span><span class="sig-name descname"><span class="pre">RGCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basiclayer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#RGCN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RGCN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#neuralkg_ind.model.GNNModel.model.Model" title="neuralkg_ind.model.GNNModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p>RGCN model</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RGCN.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RGCN.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RGCN.basiclayer">
<span class="sig-name descname"><span class="pre">basiclayer</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RGCN.basiclayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Layer of RGCN model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RGCN.inp_dim">
<span class="sig-name descname"><span class="pre">inp_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RGCN.inp_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of input.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RGCN.emb_dim">
<span class="sig-name descname"><span class="pre">emb_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RGCN.emb_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of embedding.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RGCN.aggregator">
<span class="sig-name descname"><span class="pre">aggregator</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RGCN.aggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of aggregator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RGCN.build_hidden_layer">
<span class="sig-name descname"><span class="pre">build_hidden_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#RGCN.build_hidden_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RGCN.build_hidden_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>build hidden layer of RGCN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> – The idx of layer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Build a basic layer according to whether it is the first layer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>output</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RGCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#RGCN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RGCN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Getting nodes embedding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>g</strong> – Subgraph of corresponding task.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nodes embedding.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>g.ndata[‘h’]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.RGCN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.RGCN.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.KGEModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neuralkg_ind.model.GNNModel.MorsE.</span></span><span class="sig-name descname"><span class="pre">KGEModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#KGEModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.KGEModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>KGE model</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.KGEModel.args">
<span class="sig-name descname"><span class="pre">args</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.KGEModel.args" title="Permalink to this definition">¶</a></dt>
<dd><p>Model configuration parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.KGEModel.model_name">
<span class="sig-name descname"><span class="pre">model_name</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.KGEModel.model_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.KGEModel.nrelation">
<span class="sig-name descname"><span class="pre">nrelation</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.KGEModel.nrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of relation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.KGEModel.emb_dim">
<span class="sig-name descname"><span class="pre">emb_dim</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.KGEModel.emb_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of embedding.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.KGEModel.epsilon">
<span class="sig-name descname"><span class="pre">epsilon</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.KGEModel.epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate embedding_range.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.KGEModel.margin">
<span class="sig-name descname"><span class="pre">margin</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.KGEModel.margin" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate embedding_range and loss.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.KGEModel.embedding_range">
<span class="sig-name descname"><span class="pre">embedding_range</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.KGEModel.embedding_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Uniform distribution range.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.KGEModel.relation_embedding">
<span class="sig-name descname"><span class="pre">relation_embedding</span></span><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.KGEModel.relation_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Embedding of relation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.KGEModel.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.KGEModel.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neuralkg_ind.model.GNNModel.MorsE.KGEModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ent_emb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/neuralkg_ind/model/GNNModel/MorsE.html#KGEModel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neuralkg_ind.model.GNNModel.MorsE.KGEModel.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Forward function that calculate the score of a batch of triples.</dt><dd><p>In the ‘single’ mode, sample is a batch of triple.
In the ‘head-batch’ or ‘tail-batch’ mode, sample consists two part.
The first part is usually the positive sample.
And the second part is the entities in the negative samples.
Because negative samples and positive samples usually share two elements
in their triple ((head, relation) or (relation, tail)).</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> – Positive and negative sample.</p></li>
<li><p><strong>ent_emb</strong> – Embedding of entities.</p></li>
<li><p><strong>mode</strong> – ‘single’, ‘head-batch’ or ‘tail-batch’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The score of sample.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>score</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rulemodel.html" class="btn btn-neutral float-left" title="RuleModel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="neuralkg_ind.utils.html" class="btn btn-neutral float-right" title="Utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, zjukg.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>